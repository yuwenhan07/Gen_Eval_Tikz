\begin{tikzpicture}[every node/.style={draw,outer sep=0pt},font=\scriptsize]
    \matrix(m)[matrix of math nodes,ampersand replacement=\&,
    row sep=-\pgflinewidth,column sep=-\pgflinewidth,nodes={minimum width=2em,minimum height=8em}]{
      \underline{\widetilde{w}_1}&  & \\
      \underline{\widetilde{w}_1}&&& \\
      \underline{\widetilde{w}_2}& &&& \underline{\widetilde{w}_2} \\
      &&&&\\};
    \draw[double distance=0.7mm] (m-1-1.north west) -- (m-1-1.north east);
    \draw[double distance=0.7mm] (m-2-1.north west) -- (m-2-1.north east);
    \draw[double distance=0.7mm] (m-3-1.north west) -- (m-3-1.north east);
    \draw[double distance=0.7mm] (m-3-5.north west) -- (m-3-5.north east);

    \draw (m-1-1.east) |- ($(m-2-1.west)!0.5!(m-3-1.east)$) coordinate[midway](aux)
          -- ([yshift=1ex]aux);
    \draw (m-2-1.east) |- (m-3-4.south) coordinate[midway](aux)
          -- ([xshift=1ex]aux);
    \draw[dashed] (m-3-5.east) |- ([yshift=-1ex]aux);
    \node at (aux) {\footnotesize $w_1$};
    \node at ($(m-3-3.south)!0.5!(aux)$) {\footnotesize $w_1$};

    \draw (m-3-1.south west) arc[start angle=180,end angle=360,radius=3em];
    \draw[double distance=0.7mm] (m-2-1.south west) -- (m-2-1.south east);
    \draw (m-2-1.south west) arc[start angle=180,end angle=360,radius=3em];
    \draw[double distance=0.7mm] (m-3-5.south west) -- (m-3-5.south east);
    \end{tikzpicture}