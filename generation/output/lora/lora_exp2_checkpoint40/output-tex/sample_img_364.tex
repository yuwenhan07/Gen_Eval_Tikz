documentclass[]
\usepackage{tikz}
\usetikzlibrary{calc}
\tikzset{
    base/.style={
        minimum height=5mm,
        inner sep=1pt
    },
    base2/.style={
        minimum height=7mm,
        inner sep=1pt
    },
    mainline/.style={
        draw,
        fill=white,
        line width=1pt,
        >=stealth,
        shorten >=1pt
    },
    mainline2/.style={
        draw,
        fill=white,
        line width=0.8pt,
        >=stealth,
        shorten >=1pt
    },
    arrow/.style={
        draw,
        line width=1pt,
        >=stealth,
        shorten >=1pt
    },
    label/.style={
        font=\footnotesize,
        inner sep=0pt
    },
    label2/.style={
        font=\tiny,
        inner sep=0pt
    },
    name/.style={
        font=\tiny,
        text depth=0pt,
        inner sep=0pt
    },
    attr/.style={
        font=\scriptsize,
        text depth=0pt,
        inner sep=0pt,
        anchor=south
    },
    box/.style={
        base,
        fill=gray!30,
        rounded corners=1pt,
        draw,
        thick,
        align=center,
        append after command={
            (\tikzlastnode.north west) edge (current bounding box.north west)
            (\tikzlastnode.south east) edge (current bounding box.south east)
        }
    },
    box2/.style={
        base2,
        fill=gray!30,
        rounded corners=1pt,
        draw,
        thick,
        align=center,
        append after command={
            (\tikzlastnode.north west) edge (current bounding box.north west)
            (\tikzlastnode.south east) edge (current bounding box.south east)
        }
    },
    box1/.style={
        base,
        fill=gray!10,
        rounded corners=1pt,
        draw,
        thick,
        align=center,
        append after command={
            (\tikzlastnode.north west) edge (current bounding box.north west)
            (\tikzlastnode.south east) edge (current bounding box.south east)
        }
    },
    box2d/.style={
        base,
        fill=red!20,
        rounded corners=1pt,
        draw,
        thick,
        align=center,
        append after command={
            (\tikzlastnode.north west) edge (current bounding box.north west)
            (\tikzlastnode.south east) edge (current bounding box.south east)
        }
    },
    node/.style={
        fill=white,
        circle,
        inner sep=1pt,
        draw,
        line width=1pt,
        >=stealth,
        shorten >=1pt
    },
    edge/.style={
        draw,
        fill=white,
        line width=1pt,
        >=stealth,
        shorten >=1pt
    }
}

\begin{document}
\begin{figure}[htbp]
\centering
\begin{tikzpicture}[node distance=1cm]

\node[box1,label={[name=label]right:{\includegraphics[scale=.3]{figs/bert.pdf}}}](input){};
\node[box,right of=input,xshift=6cm,yshift=2cm](x0){tc0[9188]\#37};
\node[right of=x0,xshift=-1cm](attr_0){\attr{1}};

\node[right of=x0,xshift=4cm,yshift=1.5cm](x1){tc2[3900]\#37};
\node[right of=x1,xshift=-1cm](attr_1){\attr{1}};
\node[right of=x1,xshift=-4cm,yshift=-0.5cm](x2){tc1[22184]\#37};
\node[right of=x2,xshift=-1cm](attr_2){\attr{2}};
\node[right of=x2,xshift=-4cm,yshift=-1cm](x3){tc8[355]\#37};

\node[right of=input,xshift=-1cm,yshift=2cm](embed){embed\#37};
\node[right of=embed,xshift=-2cm](attr_embed){\attr{1}};
\node[right of=embed,xshift=-4cm,yshift=-1cm](att0){atten0[3]\#37};

\node[right of=input,xshift=-1cm,yshift=1cm](att00){atten0[5]\#37};
\node[right of=att00,xshift=-2cm](attr_att0){\attr{1}};
\node[right of=att00,xshift=-4cm,yshift=-1cm](att1){atten0[1]\#37};

\draw[mainline] (input.south)--(embed.north);
\draw[mainline] (input.south)--(att0.north);
\draw[mainline] (input.south)--(att00.north);

\draw[mainline] (embed.east)--(attr_embed.north);
\draw[mainline] (att0.east)--(attr_att0.north);
\draw[mainline] (att00.east)--(att1.north);

\draw[mainline] (att0.east)--(x0.west);
\draw[mainline] (att00.east)--(x0.west);
\draw[mainline] (embed.east)--(x0.west);

\draw[mainline] (x0.east)--(attr_0.north);
\draw[mainline] (x1.west)--(attr_1.north);
\draw[mainline] (x2.west)--(attr_2.north);
\draw[mainline] (x3.east)--(attr_2.north);

\draw[mainline] (x0.east)--(x1.west);
\draw[mainline] (x0.east)--(x3.west);
\draw[mainline] (x1.east)--(x2.west);
\draw[mainline] (x1.east)--(x3.west);
\draw[mainline] (x2.east)--(x3.west);

\draw[arrow] (x0.south)--(att1.north);
\draw[arrow] (x1.south)--(att1.north);
\draw[arrow] (x2.south)--(att1.north);

\end{tikzpicture}
\caption{An example of a computational graph produced using the method in \S\ref{sec:subgraphs} characterizing how our unknown feature is computed on an unseen input. A single path is highlighted in red and annotated with component-by-component attributions.}
\label{fig:computationalgraph}
\end{figure}
\end{document}