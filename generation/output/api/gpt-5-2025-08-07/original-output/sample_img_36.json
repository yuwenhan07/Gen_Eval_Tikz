{
  "timestamp": "2025-09-10T14:33:43",
  "model": "gpt-5-2025-08-07",
  "temperature": 0.8,
  "top_p": 0.9,
  "max_tokens": 2048,
  "sample_index": 36,
  "image_rel_path": "images/test_36.png",
  "caption": "Overview of the used architecture based on the FourCastNet model \\cite{pathak2022fourcastnet}. We initialize the model from pre-trained weights \\cite{fcn_weights} and replace the weather-specific head with a linear head for modelling the normalized difference vegetation index (NDVI).",
  "snippet_input": "",
  "raw_output": "% Standalone, directly compilable TikZ figure\n\\documentclass[tikz,border=6pt]{standalone}\n\\usepackage{tikz}\n\\usetikzlibrary{arrows.meta,positioning,fit}\n\\usepackage{xcolor}\n\n\\begin{document}\n\\begin{tikzpicture}[\n    font=\\small,\n    >=Stealth,\n    block/.style={draw, rounded corners, minimum width=2.1cm, minimum height=3.4cm, fill=gray!22},\n    mix/.style={draw, minimum width=2.3cm, minimum height=3.4cm, fill=gray!22},\n    lab/.style={inner sep=1pt},\n    arr/.style={->, line width=0.9pt},\n    gridline/.style={line width=0.25pt}\n]\n\n% -------------------------------------------------\n% Left: Input grid (stacked) with label \"Input\"\n% -------------------------------------------------\n\\begin{scope}[shift={(-8.3,0)}]\n  % Back (offset) grid to suggest stack\n  \\begin{scope}[xshift=-0.22cm,yshift=0.22cm]\n    \\draw[gridline] (-3.8,-1.55) rectangle (0.0,1.55);\n    % verticals\n    \\foreach \\x in {-3.5,-3.2,...,-0.3} \\draw[gridline] (\\x,-1.55) -- (\\x,1.55);\n    % horizontals\n    \\foreach \\y in {-1.25,-0.95,...,1.25} \\draw[gridline] (-3.8,\\y) -- (0.0,\\y);\n  \\end{scope}\n  % Front grid\n  \\draw[gridline] (-3.8,-1.55) rectangle (0.0,1.55);\n  \\foreach \\x in {-3.5,-3.2,...,-0.3} \\draw[gridline] (\\x,-1.55) -- (\\x,1.55);\n  \\foreach \\y in {-1.25,-0.95,...,1.25} \\draw[gridline] (-3.8,\\y) -- (0.0,\\y);\n\n  \\node[lab] at (-1.9,-2.05) {Input};\n\\end{scope}\n\n% -------------------------------------------------\n% Channel/icon column between input and embedding\n% -------------------------------------------------\n\\begin{scope}[shift={(-3.2,0)}]\n  % vertical column of small squares (features/channels)\n  \\foreach \\i [count=\\k] in {-1.8,-1.35,-0.9,-0.45,0,0.45,0.9,1.35,1.8} {\n      \\draw[fill=white, line width=0.4pt] (0.0,\\i-0.18) rectangle +(0.36,0.36);\n  }\n  % arrows from a few representative ones into embedding\n  \\draw[arr] (0.36,1.35) -- ++(0.9,0.55);\n  \\draw[arr] (0.36,0.00) -- ++(0.9,0.00);\n  \\draw[arr] (0.36,-1.35) -- ++(0.9,-0.55);\n\\end{scope}\n\n% -------------------------------------------------\n% Embedding block\n% -------------------------------------------------\n\\node[block] (emb) at (-0.3,0) {Embedding};\n\n% -------------------------------------------------\n% Transformer block with Spatial/Channel mixing\n% -------------------------------------------------\n\\node[mix, right=1.7cm of emb] (sp) {};\n\\node[mix, right=1.3cm of sp] (ch) {};\n\n% Titles inside mixing blocks\n\\node[lab] at (sp) {Spatial Mixing};\n\\node[lab, align=center, text=gray!60] at ([xshift=-0.45cm,yshift=-1.15cm]sp.south) {Fourier\\\\Space};\n\\node[lab] at (ch) {Channel Mixing};\n\n% Arrows between blocks\n\\draw[arr] (emb.east) -- (sp.west);\n\\draw[arr] (sp.east) -- (ch.west);\n\n% Dashed orange wrapper indicating repeated Transformer block\n\\node[draw=orange!85!black, dashed, line width=0.8pt, inner sep=6pt, fit=(sp)(ch)] (tfbox) {};\n\\node[lab, above=2mm of tfbox, text=gray!60] {Transformer Block};\n\\node[lab, below=2mm of tfbox, text=gray!60] {$L$ times};\n\n% -------------------------------------------------\n% Final linear head\n% -------------------------------------------------\n\\node[block, right=1.7cm of ch] (lin) {Linear\\\\Layer};\n\n\\draw[arr] (ch.east) -- (lin.west);\n\n% Annotation: NDVI head replacement (optional side note)\n\\node[align=center, text=gray!60] at ([yshift=-2.0cm]lin.south) {Initialized from FourCastNet \\cite{pathak2022fourcastnet}\\\\\nreplacing the weather-specific head with a linear head for NDVI \\cite{fcn_weights}.};\n\n\\end{tikzpicture}\n\\end{document}",
  "extracted_code": "\\begin{tikzpicture}[\n    font=\\small,\n    >=Stealth,\n    block/.style={draw, rounded corners, minimum width=2.1cm, minimum height=3.4cm, fill=gray!22},\n    mix/.style={draw, minimum width=2.3cm, minimum height=3.4cm, fill=gray!22},\n    lab/.style={inner sep=1pt},\n    arr/.style={->, line width=0.9pt},\n    gridline/.style={line width=0.25pt}\n]\n\n% -------------------------------------------------\n% Left: Input grid (stacked) with label \"Input\"\n% -------------------------------------------------\n\\begin{scope}[shift={(-8.3,0)}]\n  % Back (offset) grid to suggest stack\n  \\begin{scope}[xshift=-0.22cm,yshift=0.22cm]\n    \\draw[gridline] (-3.8,-1.55) rectangle (0.0,1.55);\n    % verticals\n    \\foreach \\x in {-3.5,-3.2,...,-0.3} \\draw[gridline] (\\x,-1.55) -- (\\x,1.55);\n    % horizontals\n    \\foreach \\y in {-1.25,-0.95,...,1.25} \\draw[gridline] (-3.8,\\y) -- (0.0,\\y);\n  \\end{scope}\n  % Front grid\n  \\draw[gridline] (-3.8,-1.55) rectangle (0.0,1.55);\n  \\foreach \\x in {-3.5,-3.2,...,-0.3} \\draw[gridline] (\\x,-1.55) -- (\\x,1.55);\n  \\foreach \\y in {-1.25,-0.95,...,1.25} \\draw[gridline] (-3.8,\\y) -- (0.0,\\y);\n\n  \\node[lab] at (-1.9,-2.05) {Input};\n\\end{scope}\n\n% -------------------------------------------------\n% Channel/icon column between input and embedding\n% -------------------------------------------------\n\\begin{scope}[shift={(-3.2,0)}]\n  % vertical column of small squares (features/channels)\n  \\foreach \\i [count=\\k] in {-1.8,-1.35,-0.9,-0.45,0,0.45,0.9,1.35,1.8} {\n      \\draw[fill=white, line width=0.4pt] (0.0,\\i-0.18) rectangle +(0.36,0.36);\n  }\n  % arrows from a few representative ones into embedding\n  \\draw[arr] (0.36,1.35) -- ++(0.9,0.55);\n  \\draw[arr] (0.36,0.00) -- ++(0.9,0.00);\n  \\draw[arr] (0.36,-1.35) -- ++(0.9,-0.55);\n\\end{scope}\n\n% -------------------------------------------------\n% Embedding block\n% -------------------------------------------------\n\\node[block] (emb) at (-0.3,0) {Embedding};\n\n% -------------------------------------------------\n% Transformer block with Spatial/Channel mixing\n% -------------------------------------------------\n\\node[mix, right=1.7cm of emb] (sp) {};\n\\node[mix, right=1.3cm of sp] (ch) {};\n\n% Titles inside mixing blocks\n\\node[lab] at (sp) {Spatial Mixing};\n\\node[lab, align=center, text=gray!60] at ([xshift=-0.45cm,yshift=-1.15cm]sp.south) {Fourier\\\\Space};\n\\node[lab] at (ch) {Channel Mixing};\n\n% Arrows between blocks\n\\draw[arr] (emb.east) -- (sp.west);\n\\draw[arr] (sp.east) -- (ch.west);\n\n% Dashed orange wrapper indicating repeated Transformer block\n\\node[draw=orange!85!black, dashed, line width=0.8pt, inner sep=6pt, fit=(sp)(ch)] (tfbox) {};\n\\node[lab, above=2mm of tfbox, text=gray!60] {Transformer Block};\n\\node[lab, below=2mm of tfbox, text=gray!60] {$L$ times};\n\n% -------------------------------------------------\n% Final linear head\n% -------------------------------------------------\n\\node[block, right=1.7cm of ch] (lin) {Linear\\\\Layer};\n\n\\draw[arr] (ch.east) -- (lin.west);\n\n% Annotation: NDVI head replacement (optional side note)\n\\node[align=center, text=gray!60] at ([yshift=-2.0cm]lin.south) {Initialized from FourCastNet \\cite{pathak2022fourcastnet}\\\\\nreplacing the weather-specific head with a linear head for NDVI \\cite{fcn_weights}.};\n\n\\end{tikzpicture}"
}